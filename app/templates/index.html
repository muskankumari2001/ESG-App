<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>PSO Bill Management Portal</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body {
            background: #f4f9f5;
        }
        .pso-header {
            background: linear-gradient(90deg, #00873e 0%, #f8d400 100%);
            padding: 30px 0 10px 0;
            margin-bottom: 35px;
            border-radius: 0 0 30px 30px;
            box-shadow: 0 4px 16px rgba(0,135,62,0.08);
        }
        .pso-logo {
            height: 120px;
        }
        .title-text {
            color: #006837;
            font-weight: bold;
            letter-spacing: 2px;
        }
        .disco-card {
            border: 2px solid #f8d400;
            min-width: 220px;
            margin-bottom: 22px;
            border-radius: 1.5rem;
            transition: box-shadow 0.2s, transform 0.2s;
        }
        .disco-card:hover {
            box-shadow: 0 6px 16px #c9ebd8;
            transform: translateY(-2px) scale(1.03);
            border-color: #00873e;
        }
        .fetch-btn {
            margin-top: 25px;
            background: linear-gradient(90deg, #00873e 60%, #f8d400 100%);
            border: none;
            color: #fff;
            font-weight: 500;
            letter-spacing: 1px;
        }
        .fetch-btn:hover {
            background: linear-gradient(90deg, #f8d400 20%, #00873e 100%);
            color: #00482b;
        }
        .btn-success {
            background: #00873e;
            border: none;
            font-weight: 600;
            letter-spacing: 1px;
        }
        .btn-success:hover {
            background: #f8d400;
            color: #00873e;
        }
        /* Loader overlay styles */
        #loading-overlay {
            position: fixed;
            z-index: 9999;
            top: 0; left: 0;
            width: 100vw; height: 100vh;
            background: rgba(244,249,245,0.97);
            display: none;
            align-items: center;
            justify-content: center;
            flex-direction: column;
            font-size: 1.8rem;
            color: #006837;
            letter-spacing: 1px;
            font-weight: bold;
        }
        /* HTML: <div class="loader"></div> */
        .loader {
          width: 50px;
          aspect-ratio: 1;
          display: grid;
        }
        .loader::before,
        .loader::after {
          content:"";
          grid-area: 1/1;
          --c:no-repeat radial-gradient(farthest-side,#25b09b 92%,#0000);
          background:
            var(--c) 50%  0,
            var(--c) 50%  100%,
            var(--c) 100% 50%,
            var(--c) 0    50%;
          background-size: 12px 12px;
          animation: l12 1s infinite;
        }
        .loader::before {
          margin: 4px;
          filter: hue-rotate(45deg);
          background-size: 8px 8px;
          animation-timing-function: linear
        }

        @keyframes l12 {
          100%{transform: rotate(.5turn)}
        }
    </style>
</head>
<body>
<!-- Loader Overlay -->
<div id="loading-overlay">
    <div class="loader"></div>
    <div style="color:#25b09b;font-weight:bold;margin-top:10px;font-size:1.3rem;letter-spacing:1px;">Fetching and extracting text...</div>
</div>

<div class="container-fluid pso-header text-center mb-5">
    <img src="{{ url_for('static', filename='pso-removebg-preview.png') }}" alt="PSO Logo" class="pso-logo">
    <h1 class="title-text mt-2 mb-0">Pakistan State Oil</h1>
    <div class="mb-2" style="color: #006837; font-size: 1.2rem; letter-spacing:1px;">Bill Management Portal</div>
</div>

<div class="container pb-5">
    <div class="d-flex justify-content-end align-items-center mb-4">
        <form action="{{ url_for('main.fetch_all') }}" method="post" class="fetch-form">
            <button type="submit" class="btn btn-success btn-lg">Fetch All Bills</button>
        </form>
    </div>

    <div class="row">
        {% for disco in disco_list %}
        <div class="col-md-4">
            <div class="card disco-card shadow-sm">
                <div class="card-body text-center">
                    <h4 class="card-title mb-3" style="color: #00873e;">{{ disco }}</h4>
                    <form action="{{ url_for('main.fetch_disco', disco_name=disco) }}" method="post" class="fetch-form">
                        <button type="submit" class="btn fetch-btn w-100">Fetch {{ disco }} Bills</button>
                    </form>
                </div>
            </div>
        </div>
        {% endfor %}
    </div>
</div>
<script>
    // Show the loading overlay on ANY fetch-form submit
    document.querySelectorAll('.fetch-form').forEach(function(form){
        form.addEventListener('submit', function(){
            document.getElementById('loading-overlay').style.display = 'flex';
        });
    });
</script>
</body>
</html>
